

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mode Switching and Behavior Trees &mdash; CoHAN2.0  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=40d87414" />

  
    <link rel="canonical" href="https://laas-hri.github.io/CoHAN2.0_docs/mode_switching.html" />
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CoHAN Sim" href="cohan_sim.html" />
    <link rel="prev" title="Usage Tutorial" href="tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            CoHAN2.0
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="home.html">CoHAN2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Usage Tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Mode Switching and Behavior Trees</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#cohan2-0-behavior-tree">CoHAN2.0 Behavior Tree</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cohan_sim.html">CoHAN Sim</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/library_root.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="cohan_msgs.html">CoHAN_Msgs</a></li>
<li class="toctree-l1"><a class="reference internal" href="versions.html">Version History</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CoHAN2.0</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Mode Switching and Behavior Trees</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/mode_switching.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mode-switching-and-behavior-trees">
<h1>Mode Switching and Behavior Trees<a class="headerlink" href="#mode-switching-and-behavior-trees" title="Link to this heading"></a></h1>
<p>In this section, we will explain how we switch between different modes using Behavior Trees (BTs). CoHAN2.0 integrates BTs to switch between different planning modalities and facilitate more modular architecture. You can add new or remove existing modalities by using an xml file.</p>
<section id="cohan2-0-behavior-tree">
<h2>CoHAN2.0 Behavior Tree<a class="headerlink" href="#cohan2-0-behavior-tree" title="Link to this heading"></a></h2>
<p>The BT that integrates all modalities in CoHAN2.0 is shown below.</p>
<a class="reference internal image-reference" href="_images/modes.png"><img alt="Modes diagram" class="align-center" src="_images/modes.png" style="width: 100%;" />
</a>
<br><p>The BT looks for a goal update and as soon as it receives a new goal, it starts ticking the right branch to switch between different modes based on the conditions. At each instance, it looks for a passage detection and if a passage is detected, it activates the PassThrough mode for the given timeout (configurable). If no passage is detected or the PassThrough is done, it switches to the cycling mode sequence used by CoHAN  (refer to paper for details on different modes). The switch from one mode to another happens when an exit condition is met.</p>
<p>The default xml used by CoHAN2.0 is shown below:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;root</span><span class="w"> </span><span class="na">BTCPP_format=</span><span class="s">&quot;4&quot;</span><span class="w"> </span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;BehaviorTree</span><span class="w"> </span><span class="na">ID=</span><span class="s">&quot;MainTree&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ReactiveFallback&gt;</span>
<span class="w">            </span><span class="cm">&lt;!-- Condition --&gt;</span>
<span class="w">            </span><span class="nt">&lt;isGoalUpdated</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;goal_update_check&quot;</span><span class="w"> </span><span class="na">goal_update=</span><span class="s">&quot;{goal_update}&quot;</span><span class="w"> </span><span class="na">recovery=</span><span class="s">&quot;{recovery}&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;ReactiveFallback</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;goal_tree&quot;</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="cm">&lt;!-- First Control --&gt;</span>
<span class="w">                </span><span class="nt">&lt;Sequence&gt;</span>
<span class="w">                    </span><span class="nt">&lt;passThroughCond</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;is_passage_detected&quot;</span><span class="w"> </span><span class="na">passage_type=</span><span class="s">&quot;{passage_type}&quot;</span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;Timeout</span><span class="w"> </span><span class="na">msec=</span><span class="s">&quot;5000&quot;</span><span class="nt">&gt;</span>
<span class="w">                        </span><span class="nt">&lt;setMode</span><span class="w"> </span><span class="na">plan_type=</span><span class="s">&quot;passthrough&quot;</span><span class="w"> </span><span class="na">predict_type=</span><span class="s">&quot;const_vel&quot;</span><span class="w"> </span><span class="na">mode=</span><span class="s">&quot;{planning_mode}&quot;</span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/Timeout&gt;</span>
<span class="w">                </span><span class="nt">&lt;/Sequence&gt;</span>
<span class="w">                </span><span class="cm">&lt;!-- Second Control --&gt;</span>
<span class="w">                </span><span class="nt">&lt;Sequence&gt;</span>
<span class="w">                    </span><span class="nt">&lt;ReactiveFallback&gt;</span>
<span class="w">                        </span><span class="nt">&lt;singleBandExitCond</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;single band mode&quot;</span><span class="w"> </span><span class="na">agents_info=</span><span class="s">&quot;{agents_info}&quot;</span><span class="w"> </span><span class="na">dist_max=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
<span class="w">                        </span><span class="nt">&lt;setMode</span><span class="w"> </span><span class="na">plan_type=</span><span class="s">&quot;single&quot;</span><span class="w"> </span><span class="na">predict_type=</span><span class="s">&quot;const_vel&quot;</span><span class="w"> </span><span class="na">mode=</span><span class="s">&quot;{planning_mode}&quot;</span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/ReactiveFallback&gt;</span>
<span class="w">                    </span><span class="nt">&lt;ReactiveFallback&gt;</span>
<span class="w">                        </span><span class="nt">&lt;dualBandExitCond</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dual band mode&quot;</span><span class="w"> </span><span class="na">agents_info=</span><span class="s">&quot;{agents_info}&quot;</span><span class="w"> </span><span class="na">dist_threshold=</span><span class="s">&quot;2.5&quot;</span><span class="w"> </span><span class="na">nav_goal=</span><span class="s">&quot;{nav_goal}&quot;</span><span class="nt">/&gt;</span>
<span class="w">                        </span><span class="nt">&lt;setMode</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dual_band&quot;</span><span class="w"> </span><span class="na">plan_type=</span><span class="s">&quot;dual&quot;</span><span class="w"> </span><span class="na">predict_type=</span><span class="s">&quot;behind&quot;</span><span class="w"> </span><span class="na">mode=</span><span class="s">&quot;{planning_mode}&quot;</span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/ReactiveFallback&gt;</span>
<span class="w">                    </span><span class="nt">&lt;ReactiveFallback&gt;</span>
<span class="w">                        </span><span class="nt">&lt;velobsExitCond</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;velobs mode&quot;</span><span class="w"> </span><span class="na">agents_info=</span><span class="s">&quot;{agents_info}&quot;</span><span class="w"> </span><span class="na">agents_ptr=</span><span class="s">&quot;{agents_ptr}&quot;</span><span class="w"> </span><span class="na">stuck_agent=</span><span class="s">&quot;{stuck_agent}&quot;</span><span class="nt">/&gt;</span>
<span class="w">                        </span><span class="nt">&lt;setMode</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;vel_obs_&quot;</span><span class="w"> </span><span class="na">plan_type=</span><span class="s">&quot;velobs&quot;</span><span class="w"> </span><span class="na">predict_type=</span><span class="s">&quot;const_vel&quot;</span><span class="w"> </span><span class="na">mode=</span><span class="s">&quot;{planning_mode}&quot;</span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/ReactiveFallback&gt;</span>
<span class="w">                    </span><span class="nt">&lt;ReactiveFallback&gt;</span>
<span class="w">                        </span><span class="nt">&lt;backoffExitCond</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;backoff&quot;</span><span class="w"> </span><span class="na">agents_info=</span><span class="s">&quot;{agents_info}&quot;</span><span class="w"> </span><span class="na">backoff_ptr=</span><span class="s">&quot;{backoff_ptr}&quot;</span><span class="w"> </span><span class="na">recovery=</span><span class="s">&quot;{recovery}&quot;</span><span class="w"> </span><span class="na">nav_goal=</span><span class="s">&quot;{nav_goal}&quot;</span><span class="w"> </span><span class="na">agents_ptr=</span><span class="s">&quot;{agents_ptr}&quot;</span><span class="nt">/&gt;</span>
<span class="w">                        </span><span class="nt">&lt;setMode</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;backoff_&quot;</span><span class="w"> </span><span class="na">plan_type=</span><span class="s">&quot;backoff&quot;</span><span class="w"> </span><span class="na">predict_type=</span><span class="s">&quot;predict&quot;</span><span class="w"> </span><span class="na">mode=</span><span class="s">&quot;{planning_mode}&quot;</span><span class="nt">/&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/ReactiveFallback&gt;</span>
<span class="w">                </span><span class="nt">&lt;/Sequence&gt;</span>
<span class="w">            </span><span class="nt">&lt;/ReactiveFallback&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ReactiveFallback&gt;</span>
<span class="w">    </span><span class="nt">&lt;/BehaviorTree&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</pre></div>
</div>
<p>These modes can be configured as needed and you can even add new modalities to CoHAN2.0 depending on your use case. Please have a look at code API for details on implementation.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial.html" class="btn btn-neutral float-left" title="Usage Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cohan_sim.html" class="btn btn-neutral float-right" title="CoHAN Sim" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Phani Teja Singamaneni.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>